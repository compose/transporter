language: go
go:
- 1.6.x
- 1.7.x
script: go test -v $(go list ./... | grep -v '/vendor/') -tags=integration
services:
- mongodb
- postgresql
addons:
  postgresql: '9.4'
before_script:
- psql -c "ALTER SYSTEM SET max_replication_slots = 4"
- psql -c "ALTER SYSTEM SET wal_level = logical"
- sudo /etc/init.d/postgresql restart; sleep 1
install: true
branches:
  only:
  - experimental
notifications:
  slack:
    secure: R8wvRnq0DcxiFNgUvJ3npnzY2LzU8uVyF8enqfxXNuSR3jRC2tqUosB5Qzb1CCiNicmpEwj3VTcwTozzCwcqckysFek3Pp2/oxYL8tRjqxks1zUeMHVv204l83Js8PAFVhODCQjIxZNQCdUM2fQ9q46MvdY7V8h/wGTbQKq1ZLE=
